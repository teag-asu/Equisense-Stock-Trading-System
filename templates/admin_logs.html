<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EquiSense - System Logs</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
  <style>
    .log-entry { padding: 0.5em 0; border-bottom: 1px solid #ddd; font-family: monospace; }
    .pagination { margin-top: 1em; }
    .pagination a { margin: 0 0.25em; text-decoration: none; }
    .pagination a.active { font-weight: bold; }
  </style>
</head>
<body>
  <main>
    <section class="panel">
      <h2>System Logs & Notifications</h2>
      <p>View system logs and manage notifications.</p>

      <form method="get" style="margin-bottom: 1em;">
        <label>
          Event Type:
          <select name="event_type" onchange="this.form.submit()">
            <option value="all" {% if selected_type=='all' %}selected{% endif %}>All</option>
            {% for id, label in event_types.items() %}
              <option value="{{ id }}" {% if selected_type|int == id %}selected{% endif %}>{{ label }}</option>
            {% endfor %}
          </select>
        </label>

        <label style="margin-left: 1em;">
          Logs per page:
          <select name="per_page" onchange="this.form.submit()">
            {% for n in [10,25,50,100] %}
              <option value="{{ n }}" {% if per_page==n %}selected{% endif %}>{{ n }}</option>
            {% endfor %}
          </select>
        </label>
      </form>

		<div style="background: #f5f5f5; padding: 1em; border-radius: 4px; max-height: 400px; overflow-y: auto;">
		  {% for log in logs %}
			<div class="log-entry">
			  [{{ log['timestamp'] }}] ({{ event_types.get(log['type'], 'Unknown') }})
			  {% if log['user_id'] %}User ID {{ log['user_id'] }}{% endif %}: {{ log['details'] }}
			</div>
		  {% else %}
			<div>No logs found.</div>
		  {% endfor %}
		</div>


      <div class="pagination">
        {% if page > 1 %}
          <a href="?page={{ page-1 }}&per_page={{ per_page }}&event_type={{ selected_type }}">Previous</a>
        {% endif %}

        {% for p in range(1, total_pages+1) %}
          <a href="?page={{ p }}&per_page={{ per_page }}&event_type={{ selected_type }}" class="{% if p==page %}active{% endif %}">{{ p }}</a>
        {% endfor %}

        {% if page < total_pages %}
          <a href="?page={{ page+1 }}&per_page={{ per_page }}&event_type={{ selected_type }}">Next</a>
        {% endif %}
      </div>

      <div class="buttons" style="margin-top: 2em;">
        <button type="button" onclick="alert('Clear logs functionality to be implemented')">Clear Logs</button>
        <button type="button" onclick="alert('Export logs functionality to be implemented')">Export Logs</button>
      </div>
    </section>
  </main>
</body>
</html>
